<link rel="import" href="../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/core-icons/editor-icons.html">
<link rel="import" href="../scope_elements/scope-input.html">
<link rel="import" href="../scope_elements/scope-map-input.html">
<link rel="import" href="../scope_elements/scope-date-picker.html">
<link rel="import" href="../scope_elements/scope-colors.html">

<polymer-element 
	name="gerencial-estoque-item" 
	attributes="lancamentoKey lancamento isVertical currentLancamentoKey" flex auto-vertical>
	<template>
		<style>
			:host {
			}
			paper-shadow {
				background: #FFF;
				margin:8px;
				padding:8px;
			}
			core-icon
			{
				  position: relative;
  top: 55px;
  left: -3px;
  color: {{lanc.quantidade > 0 ? '#D50000' : '#64DD17'}};
			}
		</style>
		<cardapio-globals id="g"></cardapio-globals>
		<firebase-element 
			location="{{ $.g.location }}/images/{{ pathDataCurrentObject.photo }}"
			data="{{imgData}}"></firebase-element>

		<template if="{{ lanc }}">
			<paper-shadow z="1" 
				animated
				on-set-value="{{ setValueHandler }}"
				on-select-key="{{ setValueHandler }}"
				on-click="{{ fireCurrentLancamento }}">
				<paper-ripple fit></paper-ripple>
				<div layout 
				horizontal?="{{ !isVertical }}" 
				 vertical?="{{ isVertical }}">
					<img-card 
			width="{{ isVertical ? 160 :60 }}"
			data="{{ imgData }}"></img-card>
			<core-icon 
				hidden?="{{ isVertical }}"
				icon="{{ lanc.quantidade > 0 ? 'trending-up': 'trending-down'}}"></core-icon>
					<scope-map-input 
							on-pathdata="{{ pathDataHandler }}"
							value="{{ lanc.item }}"
							label="Produto:"
							path="produtos"
							id="produtosMapInput"
		       				floatingLabel 
							attributeName="item"
							></scope-map-input>
					<scope-input
							label="Quanto {{ lanc.quantidade < 0 ? 'saiu': 'entrou' }}"
					 		value="{{ lanc.quantidade }}"
							attributeName="quantidade"
							isNumeric>
						</scope-input>
					<scope-date-picker
							value="{{ lanc.dataLancamento }}"
							label="Data LanÃ§amento"
							attributeName="dataLancamento"></scope-date-picker>
				</div>
			</paper-shadow>
		</template>
		<template if="{{ !isVertical }}">
			<style>
				img-card {margin-right: 19px}
				scope-date-picker,scope-input,scope-map-input {
					margin-right: 10px 
				}
				scope-input[label="Quantidade"] {
					width: 78px;
				}
			</style>
		</template>
	</template>
	<script>
		Polymer({
			isVertical:false,
			observe:{'lancamento':'buildLanc'},
			buildLanc:function(_old,_new)
			{
				this.lanc = this.lancamento;
			},
			pathDataHandler:function(e,d,s)
			{
				this.pathDataCurrentObject = d.pathDataCurrentObject;
			},
			setValueHandler:function(e,d,s)
			{
				var k = d.attributeName;

				if(k)
					this.lanc[k] = d.value;

				if(k && !_.isString(k))
					throw new Error('d.attributeName precisa ser uma String');

			},
			fireCurrentLancamento:function()
			{
				this.fire('set-current-lancamento',
				{
					lancamentoKey:this.lancamentoKey,
					lancamento:this.lanc
				});
			}
		});
	</script>
</polymer-element>